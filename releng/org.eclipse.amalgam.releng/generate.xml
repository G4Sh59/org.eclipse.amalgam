<?xml version="1.0" encoding="UTF-8"?>
<project name="amalgam" default="main" xmlns:zzz="eclipse.org/gmf/2008/xpand" xmlns:qvto="http://www.eclipse.org/qvt/1.0.0/Operational">
	
	<tstamp/>
	<property name="product" value="dsltk"/> <!-- default is dsltk -->
		
	<target name="main">
		<qvto:transformation
		     uri="platform:/plugin/org.eclipse.amalgam.releng.builder/transformations/processbuild.qvto">
		     <in uri="file:/${basedir}/builder/${product}/${product}.product"/>
		     <in uri="file:/${basedir}/builder/${product}/${product}.build"/>
			 <out uri="file:/${basedir}/out/build/${product}/${product}.product"/>
			 <out uri="file:/${basedir}/out/build/${product}/${product}.build"/>
			 <configProperty name="date" value="${DSTAMP}"/>
			 <configProperty name="time" value="${TSTAMP}"/>
		</qvto:transformation>
		
		<mkdir dir="${basedir}/out/build/${product}/builder"/>

		<zzz:template name="build2properties::Main" 
			inputURI="file:/${basedir}/out/build/${product}/${product}.build#/" 
			templateroot="platform:/plugin/org.eclipse.amalgam.releng.builder/templates/,platform:/plugin/org.eclipse.amalgam.releng.builder/transformations/"
			outfile="${basedir}/out/build/${product}/builder/build.properties"/>
		<zzz:template name="build2customTargets::Main" 
			inputURI="file:/${basedir}/out/build/${product}/${product}.build#/" 
			templateroot="platform:/plugin/org.eclipse.amalgam.releng.builder/templates/,platform:/plugin/org.eclipse.amalgam.releng.builder/transformations/"
			outfile="${basedir}/out/build/${product}/builder/customTargets.xml"/>
		<zzz:template name="build2script::Main" 
			inputURI="file:/${basedir}/out/build/${product}/${product}.build#/" 
			templateroot="platform:/plugin/org.eclipse.amalgam.releng.builder/templates/,platform:/plugin/org.eclipse.amalgam.releng.builder/transformations/"
			outfile="${basedir}/out/build/${product}/build.xml"/>
		<zzz:template name="build2site::Main" 
			inputURI="file:/${basedir}/out/build/${product}/${product}.build#/" 
			templateroot="platform:/plugin/org.eclipse.amalgam.releng.builder/templates/,platform:/plugin/org.eclipse.amalgam.releng.builder/transformations/"
			outfile="${basedir}/out/build/${product}/site.xml"/>
		<zzz:template name="build2page::Main" 
			inputURI="file:/${basedir}/out/build/${product}/${product}.build#/" 
			templateroot="platform:/plugin/org.eclipse.amalgam.releng.builder/templates/,platform:/plugin/org.eclipse.amalgam.releng.builder/transformations/"
			outfile="${basedir}/out/build/${product}/index.php"/>
		<zzz:template name="build2promote::Main" 
			inputURI="file:/${basedir}/out/build/${product}/${product}.build#/" 
			templateroot="platform:/plugin/org.eclipse.amalgam.releng.builder/templates/,platform:/plugin/org.eclipse.amalgam.releng.builder/transformations/"
			outfile="${basedir}/out/build/${product}/promote.xml"/>
	</target>
</project>